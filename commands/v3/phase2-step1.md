---
allowed-tools: ["Read", "Write", "Edit", "Bash"]
description: "システムのデータ構造をER図で定義"
---

# Phase2-Step1（データ構造定義）

## 概要
システムが扱うデータの構造を**ER図**（エンティティ関係図）として定義します。これにより、エンティティごとの属性、それらの間のリレーションシップを明確にします。


## 実行手順

### 1. 前ステップの成果物確認
該当するステップのドキュメントを確認し、作業ディレクトリを準備してください：

```bash
!mkdir -p docs/planning_v3/
```

### 2. 情報収集の原則
不足している情報について、必ず一つずつ順番に質問してください。複数の項目について確認が必要な場合は、必ず一つずつ順番に処理し、各質問の回答を確認してから次の質問に進むこと。

**選択肢形式の質問を優先**：
ユーザーの入力負荷を軽減するため、可能な限り選択肢形式で質問を行う。

**段階的質問テンプレート**：
```
[{purpose}]のため、まず最初の項目について番号で選択してください：

## {item_title}
以下から該当するものを選んでください（複数選択可）：
1. {option1_description}
2. {option2_description}
3. {option3_description}
4. その他（具体的に記入：_______）
---
User: 回答例: 1, 3
（{item_title}の回答を確認後、次の項目について質問）

---

## {next_item_title}
以下から最も近いものを選んでください：
1. {option1_description}
2. {option2_description}
3. {option3_description}
4. その他（具体的に記入：_______）

```
User: 回答例: 2
---


### 前ステップ成果物確認
* Phase1-Step1（アイデアと目標）
* Phase1-Step2（ユーザー要件定義）
* Phase1-Step3（ユーザーインタラクション設計）


## 依存関係
- **依存元**: Phase1-Step1（アイデアと目標）、Phase1-Step2（ユーザー要件定義）、Phase1-Step3（ユーザーインタラクション設計）
- **依存先**: Phase2-Step2（システム全体データフロー）、Phase2-Step3（API設計）、Phase3-Step2（実装設計）
### 3. 不足情報の確認と質問
**確認すべき項目:**
- システムで管理すべきデータは明確ですか？
- データ間の関係性は理解できていますか？
- データのライフサイクル（作成・更新・削除）はどうなりますか？
- データ量の想定はどの程度ですか？
- 必須項目や一意性の制約はありますか？

不足している情報について、必ず一つずつ順番に質問してください。


### 4. 設計案の提示と承認
収集した情報を基に、設計案を提示し、ユーザーの承認を得てください。

### 5. 最終確認とドキュメント作成

承認された内容を @docs/planning_v3/phase2-step1.md に出力してください

## 重要な対話ポイント
- データオブジェクトが曖昧な場合は、具体的なサンプルデータを例示して明確化してください
- 技術的制約（データベース種類、パフォーマンス要件）を確認して現実的な設計を行ってください
- 正規化レベルについてはユーザーの理解レベルに合わせて説明してください
- 将来の機能拡張やデータ量増加への対応も考慮した設計を心がけてください


## 共通の対話原則
- ユーザーの入力負荷を軽減するため、選択肢形式での質問を優先してください
- 複数の質問がある場合は、必ず一つずつ順番に処理してください
- 曖昧な回答には具体例を提示して明確化を図ってください
- ユーザーの理解レベルや経験に合わせた現実的な提案を行ってください


### 6. ステップ完了後の次ステップガイド
### 🚀 次のステップガイド

このステップで収集・整理した情報を基に、次の候補ステップを提案してください：

**ガイド原則**:
- 今回の成果物の内容に基づいて適切な次ステップを提案
- 不要と思われるステップには理由とともにスキップ提案
- 各候補ステップで何をするかを簡潔に説明
- 実行コマンドを明示
- 最終的な選択はユーザーに委ねる

**スキップ判断基準例**:
- データ量が少ない/構造が単純 → phase2-step1（データ構造定義）をスキップしてphase2-step3（API設計）へ
- UIがない/最小限 → phase1-step3（インタラクション設計）をスキップしてphase2-step1へ
- データフローが単純 → phase2-step2（システム全体データフロー）をスキップしてphase2-step3へ
- テストより実装を優先 → phase3-step1（テスト計画）をスキップしてphase3-step2へ


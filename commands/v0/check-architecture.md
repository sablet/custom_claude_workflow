---
allowed-tools: ["Read", "Grep", "Glob", "Write"]
description: "既存アーキテクチャと要求の整合性確認"
---

# アーキテクチャ変更要否判定

## 対象仕様書
@$ARGUMENTS

## コード設計原則の適用
実装判定時には以下の設計原則を重視する：
- **DRY原則**: 重複コードを排除、同一機能は一箇所に集約
- **簡潔性優先**: 同等機能なら最もコンパクトな記述を採用
- **冗長性の最小化**: 必要性が高い場合を除いて冗長な記述は避ける
- **関数・構成の効率化**: 類似処理は統合、共通パターンは抽象化

## 既存アーキテクチャ分析

### 1. 現在のアーキテクチャパターン確認
既存コードベースの構造を調査し、以下を特定:
- アプリケーション構造 (スクリプト/アプリ/API/MCP等)
- モジュール構成・分離方針
- データ処理パイプライン
- 依存関係・ライブラリ構成
- 設計パターン・コーディング規約

### 2. 要求との整合性チェック

#### 既存構造で対応可能な要素（DRY原則による評価）
- [ ] **サービス層**: 既存のsrc/service/モジュール拡張で対応可能
  - 類似処理の統合可能性を評価
  - 共通パターンの抽象化機会を確認
- [ ] **モデル層**: 既存のsrc/models/データモデル拡張で対応
  - 重複する検証ロジックの集約可能性
  - 共通基底クラスでの冗長性削減
- [ ] **API層**: 既存のsrc/api/インターフェース拡張で対応
  - エンドポイント実装の共通化機会
  - レスポンス処理の統一化可能性
- [ ] **データ検証**: 既存のPydanticモデル拡張で対応
  - バリデーション規則の重複排除
  - カスタムバリデーターの再利用
- [ ] **設定管理**: 既存のconfig/パターンで対応可能
  - 設定項目の統合・簡素化機会
- [ ] **ツールチェーン**: 既存のuv+ruff+pyright構成で対応
  - ビルドスクリプトの簡潔化機会

#### アーキテクチャ変更が必要な要素
- [ ] **アプリケーションタイプ変更**: スクリプト→Webアプリ、CLI→API等の根本的変更
- [ ] **新規モジュール・レイヤー**: 既存構造に組み込めない新規コンポーネント
- [ ] **外部システム連携**: 新規の外部API・DB・クラウドサービス連携
- [ ] **処理パラダイム変更**: 同期→非同期、バッチ→ストリーミング等
- [ ] **技術スタック変更**: 新規フレームワーク・ライブラリの必須導入

## 判定結果

### アーキテクチャ変更: [必要/不要]

**根拠:**
[判定理由を具体的に記載]

### 対応方針

#### 変更不要の場合
- 既存コードベースの拡張・修正で対応可能
- 次ステップ: `/user:plan-implementation $ARGUMENTS`

#### 変更必要の場合
- 新しいアーキテクチャ設計が必要
- 次ステップ: `/user:design-architecture $ARGUMENTS`

## 技術的考慮事項

### 影響範囲
- **変更対象ファイル**: [リスト]
- **テスト対象**: [影響を受けるテストスイート]
- **互換性**: [後方互換性への影響]

### リスク評価
- **技術リスク**: [実装上の課題]
- **運用リスク**: [既存システムへの影響]
- **保守リスク**: [長期的な保守性への影響]

---

## 推奨次ステップ

**アーキテクチャ変更不要（レイヤード設計維持）:**
```bash
/user:plan-implementation $ARGUMENTS
```

**アーキテクチャ変更必要（新規レイヤー追加）:**
```bash
/user:design-architecture $ARGUMENTS
```